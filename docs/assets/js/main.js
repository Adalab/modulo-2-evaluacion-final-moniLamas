"use strict";const input=document.querySelector(".js_input"),button=document.querySelector(".js_btn"),showResults=document.querySelector(".js_showResults"),showFavourites=document.querySelector(".js_showFav");let dataSeries=[],favourites=[];function getFromApi(){let e=input.value;fetch("http://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{dataSeries=e,renderSearch()})}function renderSearch(){showResults.innerHTML="";for(let e=0;e<dataSeries.length;e++){const t=document.createElement("li"),s=document.createElement("h4"),n=document.createElement("img");t.classList.add("js_serie"),showResults.appendChild(t),s.innerHTML=dataSeries[e].show.name,t.appendChild(s),t.id=dataSeries[e].show.id,t.appendChild(n),n.style="width: 160px",n.alt="Imagen de "+dataSeries[e].show.name,null===dataSeries[e].show.image?n.src="https://via.placeholder.com/160x224.png":n.src=dataSeries[e].show.image.medium}listenSeries()}function renderFavourite(){showFavourites.innerHTML="";for(let e=0;e<favourites.length;e++){const t=document.createElement("li"),s=document.createElement("h4"),n=document.createElement("img");showFavourites.appendChild(t),s.innerHTML=favourites[e].show.name,t.appendChild(s),t.id=favourites[e].show.id,t.appendChild(n),n.style="width: 120px",n.alt="Imagen de "+favourites[e].show.name,null===favourites[e].show.image?n.src="https://via.placeholder.com/120.png":n.src=favourites[e].show.image.medium}}function handleSearch(e){e.preventDefault(),getFromApi()}function handleSerie(e){e.currentTarget.classList.toggle("fav");const t=parseInt(e.currentTarget.id),s=dataSeries.find(e=>e.show.id===t),n=favourites.findIndex(e=>e.show.id===t);-1===n?favourites.push(s):favourites.splice(n,1),renderFavourite(),setInLocalStorage()}function listenSeries(){const e=document.querySelectorAll(".js_serie");for(const t of e)t.addEventListener("click",handleSerie)}function setInLocalStorage(){const e=JSON.stringify(favourites);localStorage.setItem("favourites",e)}function getLocalStorage(){const e=localStorage.getItem("favourites");if(null===e)getFromApi();else{const t=JSON.parse(e);favourites=t,renderFavourite()}}button.addEventListener("click",handleSearch),getLocalStorage();