"use strict";const input=document.querySelector(".js_input"),button=document.querySelector(".js_btn"),showResults=document.querySelector(".js_showResults"),showFavorites=document.querySelector(".js_showFav"),resetBtnFav=document.querySelector(".js_btnReset");let dataSeries=[],favorites=[];function getFromApi(){let e=input.value;fetch("http://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{dataSeries=e,renderSearch()})}function renderSearch(){showResults.innerHTML="";for(let e=0;e<dataSeries.length;e++){const t=document.createElement("li"),a=document.createElement("h4"),n=document.createElement("img");t.classList.add("js_serie"),showResults.appendChild(t),a.innerHTML=dataSeries[e].show.name,t.appendChild(a),t.id=dataSeries[e].show.id,t.appendChild(n),n.style="width: 160px",n.alt="Imagen de "+dataSeries[e].show.name,null===dataSeries[e].show.image?n.src="https://via.placeholder.com/160x224.png":n.src=dataSeries[e].show.image.medium}listenSeries()}function renderFavourite(){showFavorites.innerHTML="";for(let e=0;e<favorites.length;e++){const t=document.createElement("li"),a=document.createElement("h4"),n=document.createElement("img");showFavorites.appendChild(t),a.innerHTML=favorites[e].show.name,t.appendChild(a),t.id=favorites[e].show.id,t.appendChild(n),n.style="width: 120px",n.alt="Imagen de "+favorites[e].show.name,null===favorites[e].show.image?n.src="https://via.placeholder.com/120.png":n.src=favorites[e].show.image.medium}}function handleSearch(e){e.preventDefault(),getFromApi()}function handleSerie(e){e.currentTarget.classList.toggle("fav");const t=parseInt(e.currentTarget.id),a=dataSeries.find(e=>e.show.id===t),n=favorites.findIndex(e=>e.show.id===t);-1===n?favorites.push(a):favorites.splice(n,1),renderFavourite(),setInLocalStorage()}function listenSeries(){const e=document.querySelectorAll(".js_serie");for(const t of e)t.addEventListener("click",handleSerie)}function setInLocalStorage(){const e=JSON.stringify(favorites);localStorage.setItem("favorites",e)}function getLocalStorage(){const e=localStorage.getItem("favorites");if(null===e)getFromApi();else{const t=JSON.parse(e);favorites=t,renderFavourite()}}function handleResetFav(e){e.preventDefault(),favorites=[],localStorage.removeItem("favorites"),renderFavourite()}button.addEventListener("click",handleSearch),resetBtnFav.addEventListener("click",handleResetFav),getLocalStorage();