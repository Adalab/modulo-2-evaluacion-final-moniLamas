"use strict";const input=document.querySelector(".js_input"),button=document.querySelector(".js_btn"),showResults=document.querySelector(".js_showResults"),showFavourites=document.querySelector(".js_showFav"),resetBtnFav=document.querySelector("js_btnReset");let dataSeries=[],favourites=[];function getFromApi(){let e=input.value;fetch("http://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{dataSeries=e,renderSearch()})}function renderSearch(){showResults.innerHTML="";for(let e=0;e<dataSeries.length;e++){const t=document.createElement("li"),n=document.createElement("h4"),a=document.createElement("img");t.classList.add("js_serie"),showResults.appendChild(t),n.innerHTML=dataSeries[e].show.name,t.appendChild(n),t.id=dataSeries[e].show.id,t.appendChild(a),a.style="width: 160px",a.alt="Imagen de "+dataSeries[e].show.name,null===dataSeries[e].show.image?a.src="https://via.placeholder.com/160x224.png":a.src=dataSeries[e].show.image.medium}listenSeries()}function renderFavourite(){showFavourites.innerHTML="";for(let e=0;e<favourites.length;e++){const t=document.createElement("li"),n=document.createElement("h4"),a=document.createElement("img");showFavourites.appendChild(t),n.innerHTML=favourites[e].show.name,t.appendChild(n),t.id=favourites[e].show.id,t.appendChild(a),a.style="width: 120px",a.alt="Imagen de "+favourites[e].show.name,null===favourites[e].show.image?a.src="https://via.placeholder.com/120.png":a.src=favourites[e].show.image.medium}}function handleSearch(e){e.preventDefault(),getFromApi()}function handleSerie(e){e.currentTarget.classList.toggle("fav");const t=parseInt(e.currentTarget.id),n=dataSeries.find(e=>e.show.id===t),a=favourites.findIndex(e=>e.show.id===t);-1===a?favourites.push(n):favourites.splice(a,1),renderFavourite(),setInLocalStorage()}function listenSeries(){const e=document.querySelectorAll(".js_serie");for(const t of e)t.addEventListener("click",handleSerie)}function setInLocalStorage(){const e=JSON.stringify(favourites);localStorage.setItem("favourites",e)}function getLocalStorage(){const e=localStorage.getItem("favourites");if(null===e)getFromApi();else{const t=JSON.parse(e);favourites=t,renderFavourite()}}function handleResetFav(e){e.preventDefault(),storage.clear(),location.reload()}button.addEventListener("click",handleSearch),resetBtnFav.addEventListener("click",handleResetFav),getLocalStorage();